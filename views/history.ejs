<!DOCTYPE html>

<html data-theme="cupcake">

</html>

<head>

    <title>My Journal</title>
    <!-- <link rel="stylesheet" href="/src/output.css" type="text/css"> -->
    <link rel='stylesheet' href="/output.css" type="text/css" />
    <!-- load output.css from src -->
    <!-- <link href="https://fonts.googleapis.com/css?family=Baloo+Bhai|Candal|Chewy&display=swap" rel="stylesheet"> -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"
        integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
</head>

<body class="flex flex-col min-h-screen">
    <div class="container p-2 mx-auto">
        <div class="flex flex-row flex-wrap py-4">
            <aside class="w-full sm:w-1/3 md:w-1/4 px-2">
                <div class="sticky top-0 p-4 bg-white rounded-xl w-full">
                    <ul class="nav flex flex-col overflow-hidden">
                        <li class="nav-item">
                            <a class="nav-link text-purple-800 hover:text-purple-600 truncate" href="/#home">
                                <span class="fa fa-home mr-2"></span> Today
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-purple-800 hover:text-purple-600 truncate" href="/history">
                                <span class="fa fa-list-alt mr-2"></span> History </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-purple-800 hover:text-purple-600" href="/#settings">
                                <span class="fa fa-user mr-2"></span> Settings </a>
                        </li>
                    </ul>
                </div>
            </aside>
            
            <main role="main" class="w-full sm:w-2/3 md:w-3/4 pt-1 px-2">
                <h1 class="text-2xl" id="home">Previous Entries</h1>
                <hr class="my-5">
                <ul class="entry-list">
                    <% entries.sort((a, b) => new Date(b.date) - new Date(a.date)).reverse().forEach(details => { %>
                    <li class="entry-item">

                        <!-- link to hide and collapse a div showing the entry data -->
                        <a class="block rounded transition duration-150 ease-in-out mb-2 mt-2 appearance-none border-2 border-gray-200 rounded w-full py-2 px-4 leading-tight focus:outline-none focus:bg-white focus:border-purple-500 toggle-button"
                            data-te-collapse-init data-te-ripple-init data-te-ripple-color="light"
                            href="#<%= details.id %>" role="button" aria-expanded="false"
                            aria-controls="collapseExample">
                            <%= details.date %> (<%= details.rating %>) <span class="fa fa-chevron-down"></span>
                        </a>
                        <!-- div to hide and collapse -->
                        <div aria-labelledby="<%= details.id %>" class="mt-3 mb-3 details hidden">
                            <div
                                class="prose block rounded-lg border-2 border-gray-200 rounded w-full py-2 px-4 leading-none focus:outline-none focus:bg-white focus:border-purple-500 mb-2">
                                <h2 class="text-primary mb-0">Positive events <span class = "fa fa-plus"></span></h2>
                                
                                <ul class="mt-2">
                                    <li class="mt-0"><%= details.pos1 %></li>
                                    <li><%= details.pos2 %></li>
                                    <li><%= details.pos3 %></li>
                                </ul>
                                <h2 class="text-secondary mt-0 mb-2">Triggers <span class="fa fa-minus"></span></h2>
                                
                                <p><%= details.triggers %></p>
                                <h2 class="text-info mt-0 mb-2" >Extra notes <span class="fa fa-edit"></span></h2>
                                <p><%= details.comments %></p>
                                <!-- rating out of 10, changes color (green: 10, yellow 5: red 1) -->
                                <h2 class="text-warning mt-0 mb-2">Rating <span class="fa fa-star"></span></h2>
                                <p><%= details.rating %></p>
                                <!-- divider -->
                                <hr class="my-5">
                                <!-- if rating is under 5, display it in red -->
                                <% if (details.rating < 5) { %>
                                <p class="text-secondary mb-3">You were feeling bad on this day.</p>
                                <% } %>
                                <!-- else, if rating is above 7, display it in green -->
                                <% if (details.rating >= 7) { %>
                                <p class="text-primary mb-3">You were feeling good on this day.</p>
                                <% } %>
                            </div>
                        </div>



                    </li><% }) %>
                </ul>
                <!-- button to load 5 more entries -->
                <!-- <button class="load-more bg-purple-500 hover:bg-purple-700 text-white font-bold py-2 px-4 mt-3 rounded onClick="loadMore">
                    Load More
                </button> -->
            </main>
        </div>
    </div>
</body>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        $('.details').hide(); // hide all the details divs
        $('.toggle-button').click(function (e) {
            e.preventDefault();
            $(this).next('.details').slideToggle();

        });
    });
</script>